"""
–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä —Ç–µ–æ—Ä–µ–º—ã –í–∏–µ—Ç–∞
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ –∫–æ—Ä–Ω–µ–π
"""
import math
import random
import time


def solve_quadratic(a, b, c):
    """–†–µ—à–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç"""
    discriminant = b*b - 4*a*c
    
    if discriminant < 0:
        return []
    elif discriminant == 0:
        return [-b / (2*a)]
    else:
        sqrt_d = math.sqrt(discriminant)
        return [(-b + sqrt_d) / (2*a), (-b - sqrt_d) / (2*a)]


def find_divisors(n):
    """–ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –¥–µ–ª–∏—Ç–µ–ª–∏ —á–∏—Å–ª–∞ n"""
    if n == 0:
        return [0]
    
    divisors = []
    for i in range(1, abs(n) + 1):
        if n % i == 0:
            divisors.extend([i, -i])
    
    return sorted(set(divisors))


def visualize_search(p, q, show_steps=True):
    """
    –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–∏—Å–∫–∞ –∫–æ—Ä–Ω–µ–π –º–µ—Ç–æ–¥–æ–º –í–∏–µ—Ç–∞
    p, q - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É—Ä–∞–≤–Ω–µ–Ω–∏—è x¬≤ + px + q = 0
    """
    print(f"\n{'='*60}")
    print(f"–†–ï–®–ê–ï–ú: x¬≤ + ({p})x + ({q}) = 0")
    print(f"{'='*60}")
    
    target_sum = -p
    target_prod = q
    
    print(f"\nüéØ –¶–ï–õ–¨:")
    print(f"   –ù–∞–π—Ç–∏ –¥–≤–∞ —á–∏—Å–ª–∞ r‚ÇÅ –∏ r‚ÇÇ —Ç–∞–∫–∏–µ, —á—Ç–æ:")
    print(f"   ‚Ä¢ r‚ÇÅ + r‚ÇÇ = {target_sum}")
    print(f"   ‚Ä¢ r‚ÇÅ √ó r‚ÇÇ = {target_prod}")
    
    # –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∑–Ω–∞–∫–∞–º
    print(f"\nüí° –ü–û–î–°–ö–ê–ó–ö–ê –ü–û –ó–ù–ê–ö–ê–ú:")
    if target_prod > 0:
        print(f"   –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ > 0 ‚Üí –∫–æ—Ä–Ω–∏ –û–î–ò–ù–ê–ö–û–í–û–ì–û –∑–Ω–∞–∫–∞")
        if target_sum > 0:
            print(f"   –°—É–º–º–∞ > 0 ‚Üí –æ–±–∞ –∫–æ—Ä–Ω—è –ü–û–õ–û–ñ–ò–¢–ï–õ–¨–ù–´–ï")
        else:
            print(f"   –°—É–º–º–∞ < 0 ‚Üí –æ–±–∞ –∫–æ—Ä–Ω—è –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ï")
    elif target_prod < 0:
        print(f"   –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ < 0 ‚Üí –∫–æ—Ä–Ω–∏ –†–ê–ó–ù–´–• –∑–Ω–∞–∫–æ–≤")
        if target_sum > 0:
            print(f"   –°—É–º–º–∞ > 0 ‚Üí –±–æ–ª—å—à–∏–π –∫–æ—Ä–µ–Ω—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π")
        else:
            print(f"   –°—É–º–º–∞ < 0 ‚Üí –±–æ–ª—å—à–∏–π –∫–æ—Ä–µ–Ω—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π")
    else:
        print(f"   –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ = 0 ‚Üí –æ–¥–∏–Ω –∏–∑ –∫–æ—Ä–Ω–µ–π —Ä–∞–≤–µ–Ω 0")
    
    # –ù–∞—Ö–æ–¥–∏–º –¥–µ–ª–∏—Ç–µ–ª–∏
    divisors = find_divisors(target_prod)
    print(f"\nüîç –®–ê–ì 1: –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –¥–µ–ª–∏—Ç–µ–ª–∏ —á–∏—Å–ª–∞ {target_prod}")
    print(f"   –î–µ–ª–∏—Ç–µ–ª–∏: {divisors}")
    
    if show_steps:
        input("\n   [–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–±–æ—Ä–∞...]")
    
    print(f"\nüîÑ –®–ê–ì 2: –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–∞—Ä—ã –¥–µ–ª–∏—Ç–µ–ª–µ–π")
    print(f"   –ò—â–µ–º –ø–∞—Ä—É, –≥–¥–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ = {target_prod} –ò —Å—É–º–º–∞ = {target_sum}")
    print()
    
    step = 0
    found = False
    solution = None
    
    for r1 in divisors:
        if r1 == 0 and target_prod != 0:
            continue
            
        r2 = target_prod // r1 if r1 != 0 else 0
        step += 1
        
        if show_steps:
            time.sleep(0.3)  # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
        
        sum_check = r1 + r2
        prod_check = r1 * r2
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏
        status = "‚úÖ" if (sum_check == target_sum and prod_check == target_prod) else "‚ùå"
        print(f"   –ü–æ–ø—ã—Ç–∫–∞ {step}: r‚ÇÅ={r1:3}, r‚ÇÇ={r2:3} | "
              f"—Å—É–º–º–∞={sum_check:3}, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ={prod_check:4} {status}")
        
        if sum_check == target_sum and prod_check == target_prod:
            found = True
            solution = sorted([r1, r2])
            if show_steps:
                print(f"\n   üéâ –ù–ê–ô–î–ï–ù–û! –ö–æ—Ä–Ω–∏: {solution}")
            break
    
    if not found:
        print(f"\n   ‚ö†Ô∏è  –¶–µ–ª—ã–µ –∫–æ—Ä–Ω–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        roots = solve_quadratic(1, p, q)
        if roots:
            print(f"   –¢–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: {[round(r, 4) for r in roots]}")
        return None
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞
    print(f"\n‚úì –ü–†–û–í–ï–†–ö–ê:")
    print(f"   r‚ÇÅ + r‚ÇÇ = {solution[0]} + {solution[1]} = {sum(solution)} {'‚úì' if sum(solution) == target_sum else '‚úó'}")
    print(f"   r‚ÇÅ √ó r‚ÇÇ = {solution[0]} √ó {solution[1]} = {solution[0] * solution[1]} {'‚úì' if solution[0] * solution[1] == target_prod else '‚úó'}")
    
    return solution


def quick_reference():
    """–ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ —Ç–µ–æ—Ä–µ–º–µ –í–∏–µ—Ç–∞"""
    print("\n" + "="*60)
    print("–¢–ï–û–†–ï–ú–ê –í–ò–ï–¢–ê - –ë–´–°–¢–†–ê–Ø –°–ü–†–ê–í–ö–ê")
    print("="*60)
    print("\n–î–ª—è —É—Ä–∞–≤–Ω–µ–Ω–∏—è ax¬≤ + bx + c = 0:")
    print("  ‚Ä¢ –°—É–º–º–∞ –∫–æ—Ä–Ω–µ–π: r‚ÇÅ + r‚ÇÇ = -b/a")
    print("  ‚Ä¢ –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: r‚ÇÅ √ó r‚ÇÇ = c/a")
    print("\n–î–ª—è x¬≤ + px + q = 0:")
    print("  ‚Ä¢ –°—É–º–º–∞ –∫–æ—Ä–Ω–µ–π: r‚ÇÅ + r‚ÇÇ = -p")
    print("  ‚Ä¢ –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: r‚ÇÅ √ó r‚ÇÇ = q")
    print("\n–ê–õ–ì–û–†–ò–¢–ú –†–ï–®–ï–ù–ò–Ø –ó–ê 5-15 –°–ï–ö–£–ù–î:")
    print("  1Ô∏è‚É£  –ù–∞–π—Ç–∏ –¥–µ–ª–∏—Ç–µ–ª–∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —á–ª–µ–Ω–∞ q")
    print("  2Ô∏è‚É£  –ü–µ—Ä–µ–±—Ä–∞—Ç—å –ø–∞—Ä—ã, —á—å–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ = q")
    print("  3Ô∏è‚É£  –í—ã–±—Ä–∞—Ç—å –ø–∞—Ä—É, —á—å—è —Å—É–º–º–∞ = -p")
    print("  4Ô∏è‚É£  –≠—Ç–æ –∏ –µ—Å—Ç—å –∫–æ—Ä–Ω–∏!")
    print("\n–ü–†–ò–ó–ù–ê–ö–ò:")
    print("  üî¥ q > 0 ‚Üí –∫–æ—Ä–Ω–∏ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫–∞")
    print("  üîµ q < 0 ‚Üí –∫–æ—Ä–Ω–∏ —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤")
    print("  ‚ö™ q = 0 ‚Üí –æ–¥–∏–Ω –∫–æ—Ä–µ–Ω—å —Ä–∞–≤–µ–Ω 0")
    print("="*60)


def practice_mode():
    """–†–µ–∂–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å –≥–æ—Ç–æ–≤—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏"""
    examples = [
        (-5, -6, "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä"),
        (-3, 2, "–ü—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π"), 
        (2, -8, "–ö–æ—Ä–Ω–∏ —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤"),
        (-7, 12, "–ü–æ–±–æ–ª—å—à–µ –¥–µ–ª–∏—Ç–µ–ª–µ–π"),
        (1, -12, "–ù–∞–π–¥–∏ –±—ã—Å—Ç—Ä–æ!"),
        (-4, 3, "–û–±–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö"),
        (6, 9, "–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–æ—Ä–Ω–∏"),
        (-1, -20, "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞"),
    ]
    
    print("\n" + "="*60)
    print("–†–ï–ñ–ò–ú –ü–†–ê–ö–¢–ò–ö–ò")
    print("="*60)
    
    for i, (p, q, hint) in enumerate(examples, 1):
        print(f"\n{'‚îÄ'*60}")
        print(f"–ó–ê–î–ê–ß–ê {i}/8: {hint}")
        print(f"{'‚îÄ'*60}")
        
        visualize_search(p, q, show_steps=True)
        
        if i < len(examples):
            choice = input("\n[Enter - —Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞, Q - –≤—ã—Ö–æ–¥]: ").strip().lower()
            if choice == 'q':
                break


def training_mode():
    """–ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –±–µ–∑ –ø–∞—É–∑"""
    print("\n" + "="*60)
    print("–†–ï–ñ–ò–ú –ë–´–°–¢–†–û–ô –¢–†–ï–ù–ò–†–û–í–ö–ò")
    print("–†–µ—à–∞–π—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞ 5-10 —Å–µ–∫—É–Ω–¥!")
    print("="*60)
    
    try:
        n = int(input("\n–°–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á —Ä–µ—à–∏—Ç—å? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5): ") or "5")
    except ValueError:
        n = 5
    
    for i in range(n):
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –∫–æ—Ä–Ω–∏
        r1 = random.randint(-10, 10)
        r2 = random.randint(-10, 10)
        
        p = -(r1 + r2)
        q = r1 * r2
        
        print(f"\n{'‚îÄ'*60}")
        print(f"–ó–ê–î–ê–ß–ê {i+1}/{n}: x¬≤ + ({p})x + ({q}) = 0")
        print(f"{'‚îÄ'*60}")
        
        input("–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–µ—à–∏—Ç—å! [Enter –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ä–µ—à–µ–Ω–∏—è]")
        
        visualize_search(p, q, show_steps=False)


def custom_mode():
    """–†–µ—à–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è"""
    print("\n" + "="*60)
    print("–†–ï–®–ò–¢–¨ –°–í–û–ï –£–†–ê–í–ù–ï–ù–ò–ï")
    print("="*60)
    
    try:
        print("\n–í–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è x¬≤ + px + q = 0:")
        p = int(input("p = "))
        q = int(input("q = "))
        
        show = input("–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—à–∞–≥–æ–≤–æ? (y/n, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é y): ").strip().lower()
        show_steps = show != 'n'
        
        visualize_search(p, q, show_steps=show_steps)
        
    except ValueError:
        print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞!")


def main():
    """–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    print("‚ïî" + "‚ïê"*58 + "‚ïó")
    print("‚ïë" + " "*15 + "–¢–†–ï–ù–ê–ñ–ï–† –¢–ï–û–†–ï–ú–´ –í–ò–ï–¢–ê" + " "*21 + "‚ïë")
    print("‚ïë" + " "*10 + "–£—á–∏—Å—å —Ä–µ—à–∞—Ç—å –∑–∞ 5-15 —Å–µ–∫—É–Ω–¥!" + " "*19 + "‚ïë")
    print("‚ïö" + "‚ïê"*58 + "‚ïù")
    
    while True:
        print("\n‚îå" + "‚îÄ"*58 + "‚îê")
        print("‚îÇ –í–´–ë–ï–†–ò–¢–ï –†–ï–ñ–ò–ú:" + " "*42 + "‚îÇ")
        print("‚îú" + "‚îÄ"*58 + "‚î§")
        print("‚îÇ 1Ô∏è‚É£  –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ —Ç–µ–æ—Ä–µ–º–µ" + " "*28 + "‚îÇ")
        print("‚îÇ 2Ô∏è‚É£  –†–µ–∂–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∏ (8 –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π)" + " "*10 + "‚îÇ")
        print("‚îÇ 3Ô∏è‚É£  –ë—ã—Å—Ç—Ä–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (—Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–∞—á–∏)" + " "*16 + "‚îÇ")
        print("‚îÇ 4Ô∏è‚É£  –†–µ—à–∏—Ç—å —Å–≤–æ—ë —É—Ä–∞–≤–Ω–µ–Ω–∏–µ" + " "*32 + "‚îÇ")
        print("‚îÇ 0Ô∏è‚É£  –í—ã—Ö–æ–¥" + " "*48 + "‚îÇ")
        print("‚îî" + "‚îÄ"*58 + "‚îò")
        
        choice = input("\nüëâ –í–∞—à –≤—ã–±–æ—Ä: ").strip()
        
        if choice == "1":
            quick_reference()
        elif choice == "2":
            practice_mode()
        elif choice == "3":
            training_mode()
        elif choice == "4":
            custom_mode()
        elif choice == "0":
            print("\nüëã –£–¥–∞—á–∏ –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ!")
            break
        else:
            print("‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–±–æ—Ä, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞")


if __name__ == "__main__":
    main()
